var WGLCUBE_PLAYER=function(x){function H(){console.log("onPrevClick pressed")}function I(){console.log("onPlayClick pressed");var a=document.getElementById("playpause");l?(a.className="icon-play",l=!l):(l=!0,a.className="icon-pause",p=!0)}function J(){console.log("onStopClick pressed");y=u=!0}function K(){console.log("onNextClick pressed");v||(l=p=v=!0)}function B(){for(var a=new THREE.BoxGeometry(.98,.98,.98),d=new THREE.MeshFaceMaterial([new THREE.MeshBasicMaterial({color:16737792}),new THREE.MeshBasicMaterial({color:16711680}),
new THREE.MeshBasicMaterial({color:65280}),new THREE.MeshBasicMaterial({color:255}),new THREE.MeshBasicMaterial({color:16777215}),new THREE.MeshBasicMaterial({color:16776960})]),b=new THREE.MeshFaceMaterial([new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676})]),c=-m/2+.5;c<m/2;c++)for(var e=
-m/2+.5;e<m/2;e++)for(var f=-m/2+.5;f<m/2;f++){var q;q=0!==z.length&&0>z.indexOf(g.length.toString())?new THREE.Mesh(a,b):new THREE.Mesh(a,d);q.position.set(e,f,c);g.push(q);h.add(q)}a=document.getElementById("wglcube_player").getAttribute("data-init");null!==a&&(w=!0,A(a))}function C(){console.log("Reseting cube");for(var a=0,d=g.length;a<d;a++)h.remove(g[a]);g=[];B(h);A(document.getElementById("wglcube_player").getAttribute("data-steps"))}function D(a,d,b){b=b-m/2+.5-1;h.add(a);for(var c=0,e=g.length;c<
e;c++)g[c].getWorldPosition()[d]===b&&THREE.SceneUtils.attach(g[c],h,a)}function E(a,d,b){b=b-m/2+.5-1;for(var c=0,e=g.length;c<e;c++)g[c].getWorldPosition()[d]===b&&THREE.SceneUtils.detach(g[c],a,h);h.remove(a)}function A(a){if(null===a||0===a.length)return-1;"*"===a&&(a="FUR");k=[];e=0;a+=" ";for(var d=0,b="",c="";"undefined"!==typeof b;)for(var g="",r=1,q=1,l=1,n=0;5!==n;){b=a[d];switch(n){case 0:/\s/g.test(b)||(n=1,d--);"undefined"===typeof b&&(n=5);break;case 1:var h=parseInt(b);isNaN(h)?(n=
2,d--,""!==c&&(r=parseInt(c),c="")):c+=b;break;case 2:switch(b){case "R":r=m-r+1,q*=-1;case "L":g="x";break;case "U":r=m-r+1,q*=-1;case "D":g="y";break;case "F":r=m-r+1,q*=-1;case "B":g="z";break;default:return console.log("FACE to move is incorrect"),console.log("Saliendo"),-1}n=3;break;case 3:h=parseInt(b);isNaN(h)?(n=4,d--,""!==c&&(l=parseInt(c),c="")):c+=b;break;case 4:"'"===b?q*=-1:d--;if(w){var n=g,h=r,p=Math.PI/180*q*90*l;f=new THREE.Object3D;D(f,n,h);switch(n){case "x":f.rotation.x+=p;break;
case "y":f.rotation.y+=p;break;case "z":f.rotation.z+=p}f.updateMatrixWorld();E(f,n,h)}else k.push({layer:r,axis:g,times:l,radians:Math.PI/180*q*90*l});n=5;break;default:return console.log("Fatal error, state unknown."),-1}d++}w&&(w=!1)}function L(){TWEEN.update();if(p&&l){f=new THREE.Object3D;D(f,k[e].axis,k[e].layer);t=new TWEEN.Tween(f.rotation);switch(k[e].axis){case "x":t.to({x:k[e].radians},500*k[e].times);break;case "y":t.to({y:k[e].radians},500*k[e].times);break;case "z":t.to({z:k[e].radians},
500*k[e].times)}t.onComplete(function(){f.updateMatrixWorld();u=!0});p=!1;t.start()}u&&(E(f,k[e].axis,k[e].layer),u=!1,e++,e<k.length?p=!0:(l=!1,C(),e=0,document.getElementById("playpause").className="icon-play"),v&&(p=v=!1),y&&(y=!1,C(),e=0,l=p=!1,document.getElementById("playpause").className="icon-play"))}function F(a,d,b){requestAnimationFrame(function(){F(a,d,b)});a.render(h,d);L();b.update()}function G(){for(var a=document.getElementById("rubik-controls").getElementsByTagName("button"),d=.6*
a[0].offsetHeight+"px",b=0,c=a.length;b<c;b++)a[b].style.fontSize=d}x.drawControls=function(){document.getElementById("wglcube_player").innerHTML="                                              <div id='rubik-cube'></div>                                 <div id='rubik-steps-display'>                                <p id='rubik-steps'></p>                                  </div>                                                      <div id='rubik-controls'>                                     <button class='icon-previous' id='prev'></button>           <button class='icon-play'     id='playpause'></button>      <button class='icon-stop'     id='stop'></button>           <button class='icon-next'     id='next'></button>           <button class='' id='screenshot'></button>                </div>                                                      "};
var m=2,g=[],z=[],h=new THREE.Scene,k=[],e=0,w=!1,y=!1,l=!1,v=!1,p=!1,u=!1,f=null,t=null;x.render=function(){var a=document.getElementById("rubik-cube"),d=window.WebGLRenderingContext?new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}):new THREE.CanvasRenderer,b=new THREE.PerspectiveCamera(45,a.offsetWidth/a.offsetHeight,.1,1E3),c=new THREE.OrbitControls(b,d.domElement);c.noPan=!0;d.setClearColor(14211288,1);d.setSize(a.offsetWidth,a.offsetHeight);a.appendChild(d.domElement);var a=wglcube_player_root.getAttribute("data-size"),
e=document.getElementById("rubik-steps"),f=wglcube_player_root.getAttribute("data-steps");m=a?a:3;e.innerHTML=f;a=wglcube_player_root.getAttribute("data-show");null!==a&&(z=a.split(","));B();A(wglcube_player_root.getAttribute("data-steps"));G();document.getElementById("rubik-cube").addEventListener("resize",function(){console.log("resized ");var a=document.getElementById("rubik-cube"),c=a.offsetWidth,a=a.offsetHeight;d.setSize(c,a);b.aspect=c/a;b.updateProjectionMatrix();G()});document.getElementById("prev").addEventListener("click",
H);document.getElementById("playpause").addEventListener("click",I);document.getElementById("stop").addEventListener("click",J);document.getElementById("next").addEventListener("click",K);b.position.addScalar(1.4*m);F(d,b,c)};return x}(WGLCUBE_PLAYER||{});WGLCUBE_PLAYER.drawControls();
