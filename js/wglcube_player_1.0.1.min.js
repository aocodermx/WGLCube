var WGLCUBE_PLAYER=function(A){function B(){for(var a=new THREE.BoxGeometry(.98,.98,.98),b=new THREE.MeshFaceMaterial([new THREE.MeshBasicMaterial({color:16737792}),new THREE.MeshBasicMaterial({color:16711680}),new THREE.MeshBasicMaterial({color:65280}),new THREE.MeshBasicMaterial({color:255}),new THREE.MeshBasicMaterial({color:16777215}),new THREE.MeshBasicMaterial({color:16776960})]),c=new THREE.MeshFaceMaterial([new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),
new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676})]),d=-m/2+.5;d<m/2;d++)for(var e=-m/2+.5;e<m/2;e++)for(var g=-m/2+.5;g<m/2;g++){var f;f=0!==w.length&&0>w.indexOf(h.length.toString())?new THREE.Mesh(a,c):new THREE.Mesh(a,b);f.position.set(e,g,d);h.push(f);k.add(f)}a=document.getElementById("wglcube_player").getAttribute("data-init");null!==a&&(t=!0,x(a))}function C(){for(var a=
0,b=h.length;a<b;a++)k.remove(h[a]);h=[];B(k);x(document.getElementById("wglcube_player").getAttribute("data-steps"))}function D(a,b,c){c=c-m/2+.5-1;k.add(a);for(var d=0,e=h.length;d<e;d++)h[d].getWorldPosition()[b]===c&&THREE.SceneUtils.attach(h[d],k,a)}function E(a,b,c){c=c-m/2+.5-1;for(var d=0,e=h.length;d<e;d++)h[d].getWorldPosition()[b]===c&&THREE.SceneUtils.detach(h[d],a,k);k.remove(a)}function x(a){if(null===a||0===a.length)return-1;"*"===a&&(a="FUR");f=[];e=0;a+=" ";for(var b=0,c="",d="";"undefined"!==
typeof c;)for(var h="",q=1,k=1,u=1,n=0;5!==n;){c=a[b];switch(n){case 0:/\s/g.test(c)||(n=1,b--);"undefined"===typeof c&&(n=5);break;case 1:var l=parseInt(c);isNaN(l)?(n=2,b--,""!==d&&(q=parseInt(d),d="")):d+=c;break;case 2:switch(c){case "R":q=m-q+1,k*=-1;case "L":h="x";break;case "U":q=m-q+1,k*=-1;case "D":h="y";break;case "F":q=m-q+1,k*=-1;case "B":h="z";break;default:return console.log("FACE to move is incorrect"),console.log("Saliendo"),-1}n=3;break;case 3:l=parseInt(c);isNaN(l)?(n=4,b--,""!==
d&&(u=parseInt(d),d="")):d+=c;break;case 4:"'"===c?k*=-1:b--;if(t){var n=h,l=q,p=Math.PI/180*k*90*u;g=new THREE.Object3D;D(g,n,l);switch(n){case "x":g.rotation.x+=p;break;case "y":g.rotation.y+=p;break;case "z":g.rotation.z+=p}g.updateMatrixWorld();E(g,n,l)}else f.push({layer:q,axis:h,times:u,radians:Math.PI/180*k*90*u});n=5;break;default:return console.log("Fatal error, state unknown."),-1}b++}t&&(t=!1)}function H(){TWEEN.update();if(p&&l){g=new THREE.Object3D;D(g,f[e].axis,f[e].layer);r=new TWEEN.Tween(g.rotation);
switch(f[e].axis){case "x":r.to({x:f[e].radians},500*f[e].times);break;case "y":r.to({y:f[e].radians},500*f[e].times);break;case "z":r.to({z:f[e].radians},500*f[e].times)}r.onComplete(function(){g.updateMatrixWorld();y=!0});p=!1;r.start()}y&&(E(g,f[e].axis,f[e].layer),y=!1,e++,e<f.length?p=!0:(l=!1,C(),e=0,document.getElementById("playpause").className="icon-play"),v&&(p=v=!1),z&&(z=!1,C(),e=0,l=p=!1,document.getElementById("playpause").className="icon-play"))}function F(a,b,c){requestAnimationFrame(function(){F(a,
b,c)});a.render(k,b);H();c.update()}function G(){for(var a=document.getElementById("rubik-controls").getElementsByTagName("button"),b=.6*a[0].offsetHeight+"px",c=0,d=a.length;c<d;c++)a[c].style.fontSize=b}var m=2,h=[],w=[],k=new THREE.Scene,f=[],e=0,t=!1,z=!1,l=!1,v=!1,p=!1,y=!1,g=null,r=null;A.render=function(){var a=document.getElementById("wglcube_player");a.innerHTML="                                              <div id='rubik-cube'></div>                                 <div id='rubik-steps-display'>                                <p id='rubik-steps'></p>                                  </div>                                                      <div id='rubik-controls'>                                     <button class='icon-previous' id='prev'></button>           <button class='icon-play'     id='playpause'></button>      <button class='icon-stop'     id='stop'></button>           <button class='icon-next'     id='next'></button>         </div>                                                      ";
var b=document.getElementById("rubik-cube"),c=window.WebGLRenderingContext?new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}):new THREE.CanvasRenderer,d=new THREE.PerspectiveCamera(45,b.offsetWidth/b.offsetHeight,.1,1E3),e=new THREE.OrbitControls(d,c.domElement);e.noPan=!0;c.setClearColor(14211288,1);c.setSize(b.offsetWidth,b.offsetHeight);b.appendChild(c.domElement);var b=a.getAttribute("data-size"),f=document.getElementById("rubik-steps"),g=a.getAttribute("data-steps");m=b?b:3;f.innerHTML=
g;b=a.getAttribute("data-show");null!==b&&(w=b.split(","));B();x(a.getAttribute("data-steps"));G();window.addEventListener("resize",function(){var a=document.getElementById("rubik-cube"),b=a.offsetWidth,a=a.offsetHeight;c.setSize(b,a);d.aspect=b/a;d.updateProjectionMatrix();G()});document.getElementById("prev").onclick=function(){};document.getElementById("playpause").onclick=function(){var a=document.getElementById("playpause");l?(a.className="icon-play",l=!l):(l=!0,a.className="icon-pause",p=!0)};
document.getElementById("stop").onclick=function(){z=!0};document.getElementById("next").onclick=function(){v||(l=p=v=!0)};d.position.addScalar(1.4*m);F(c,d,e)};return A}(WGLCUBE_PLAYER||{});WGLCUBE_PLAYER.render();
