var WGL=function(e){return e.Cube=function(e){function t(e){d=e,E.size=d.getAttribute("data-size"),d.innerHTML="                            <div class='preview'>                                   <div class='square s1'></div>                       <div class='square s2'></div>                       <div class='square s3'></div>                       <div class='square s4'></div>                   </div>                                              <div class='cube'>                                  </div>                                          ";var t=d.getAttribute("data-show");null!==t&&(v=t.split(",")),d.addEventListener("click",E.to_interactive_mode)}function a(){h=d.getElementsByClassName("cube")[0],p=new THREE.Scene,b=window.WebGLRenderingContext?new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}):new THREE.CanvasRenderer,z=new THREE.PerspectiveCamera(45,h.offsetWidth/h.offsetHeight,.1,1e3),g=new THREE.OrbitControls(z,b.domElement),g.noPan=!0,b.setClearColor(14211288,1),b.setSize(h.offsetWidth,h.offsetHeight),h.appendChild(b.domElement),n(),h.addEventListener("resize",c),z.position.addScalar(1.4*E.size),l(b,z,g)}function n(){for(var e=new THREE.BoxGeometry(.98,.98,.98),t=new THREE.MeshFaceMaterial([new THREE.MeshBasicMaterial({color:16737792}),new THREE.MeshBasicMaterial({color:16711680}),new THREE.MeshBasicMaterial({color:65280}),new THREE.MeshBasicMaterial({color:255}),new THREE.MeshBasicMaterial({color:16777215}),new THREE.MeshBasicMaterial({color:16776960})]),a=new THREE.MeshFaceMaterial([new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676}),new THREE.MeshBasicMaterial({color:8684676})]),n=-E.size/2+.5;n<E.size/2;n++)for(var i=-E.size/2+.5;i<E.size/2;i++)for(var s=-E.size/2+.5;s<E.size/2;s++){var r=null;r=0!==v.length&&v.indexOf(u.length.toString())<0?new THREE.Mesh(e,a):new THREE.Mesh(e,t),r.position.set(i,s,n),u.push(r),p.add(r)}}function i(e,t,a){var n=a-E.size/2+.5-1;p.add(e);for(var i=0,s=u.length;i<s;i++)(0|u[i].getWorldPosition()[t])===n&&THREE.SceneUtils.attach(u[i],p,e)}function s(e,t,a){for(var n=a-E.size/2+.5-1,i=0,s=u.length;i<s;i++)(0|u[i].getWorldPosition()[t])===n&&THREE.SceneUtils.detach(u[i],e,p);p.remove(e)}function r(){var e=null;if(TWEEN.update(),w){switch(f=new THREE.Object3D,i(f,T,H),e=new TWEEN.Tween(f.rotation),T){case"x":e.to({x:R},E.STEP_TIME*m);break;case"y":e.to({y:R},E.STEP_TIME*m);break;case"z":e.to({z:R},E.STEP_TIME*m)}e.onComplete(function(){f.updateMatrixWorld(),s(f,T,H)}),w=!1,e.start()}}function o(e,t,a){switch(f=new THREE.Object3D,i(f,e,t),e){case"x":f.rotation.x+=a;break;case"y":f.rotation.y+=a;break;case"z":f.rotation.z+=a}f.updateMatrixWorld(),s(f,e,t)}function l(e,t,a){M=requestAnimationFrame(function(){l(e,t,a)}),e.render(p,t),r(),a.update()}function c(){var e=E.CubeContainer.offsetWidth,t=E.CubeContainer.offsetHeight;b.setSize(e,t),z.aspect=e/t,z.updateProjectionMatrix()}var E=this;E.size=null,E.STEP_TIME=500;var d=null,u=[],v=[],f=null,h=null,M=null,w=!1,T=null,H=null,R=null,m=null,p=null,b=null,z=null,g=null;this.to_interactive_mode=function(){var e=d.getElementsByClassName("preview")[0];e.style="display:none;",a(),d.removeEventListener("click",E.to_interactive_mode)},this.to_preview_mode=function(){var e=container.getElementsByClassName("preview")[0];for(e.style="display:block;",cancelAnimationFrame(M),b=null,z=null,g=null;h.lastChild;)h.removeChild(h.lastChild);container.addEventListener("click",E.to_interactive_mode)},this.resetCube=function(){for(var e=0,t=u.length;e<t;e++)p.remove(u[e]);u=[],n(p)},this.singleMove=function(e,t){e+=" ";for(var a=0,n="",i="",s=0,r=1,l=2,c=3,d=4,u=5;"undefined"!=typeof n;)for(var v="",f=1,h=1,M=1,p=s;p!==u;){switch(n=e[a],p){case s:/\s/g.test(n)||(p=r,a--),"undefined"==typeof n&&(p=u);break;case r:var b=parseInt(n);isNaN(b)?(p=l,a--,""!==i&&(f=parseInt(i),i="")):i+=n;break;case l:switch(n){case"R":f=E.size-f+1,h*=-1;case"L":v="x";break;case"U":f=E.size-f+1,h*=-1;case"D":v="y";break;case"F":f=E.size-f+1,h*=-1;case"B":v="z";break;default:return console.log("FACE to move is incorrect"),-1}p=c;break;case c:var z=parseInt(n);isNaN(z)?(p=d,a--,""!==i&&(M=parseInt(i),i="")):i+=n;break;case d:"'"===n?h*=-1:a--,t===!0?(T=v,H=f,R=M*h*90*(Math.PI/180),m=M,w=!0):o(v,f,M*h*90*(Math.PI/180)),p=u;break;default:return console.log("Fatal error, state unknown."),-1}a++}},t(e)},e}(WGL||{});